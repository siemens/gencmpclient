# GitHub Actions for genCMPClient
# SPDX-License-Identifier: Apache-2.0
# Copyright (c) Siemens AG, 2021-2024

name: OpenSSL compatibility

on: push

jobs:
  openssl_version:
    strategy:
      fail-fast: false
      matrix:
        branch: [openssl-3.1] #[openssl-3.0, openssl-3.1, openssl-3.2, openssl-3.3, openssl-3.4]
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: build openssl
        run: |
          git clone https://github.com/openssl/openssl.git --branch ${{ matrix.branch }} --depth 1
          cd openssl
          ./Configure shared --debug --strict-warnings
         
          cd ..
          echo "OPENSSL_DIR=$PWD/openssl" >> "$GITHUB_ENV"
          echo "$PWD/openssl/apps" >> "$GITHUB_PATH"
          echo "LD_LIBRARY_PATH=$OPENSSL_DIR:$LD_LIBRARY_PATH" >> "$GITHUB_ENV"
      - name: make
        run: |
          echo $PATH
          which openssl
          openssl version

